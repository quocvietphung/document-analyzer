<mat-sidenav-container class="dm-shell">

  <!-- Main Content -->
  <mat-sidenav-content>
    <main class="document-management-content">
      <h2 class="document-management-title">Your Documents ðŸ“‘</h2>
      <p class="document-management-subtitle">
        Browse and preview your uploaded files
      </p>

      <!-- Upload button -->
      <button mat-raised-button color="primary" class="upload-btn" (click)="uploader.click()">
        <mat-icon>cloud_upload</mat-icon>
        Upload Document
      </button>
      <input #uploader type="file" hidden (change)="onFileSelected($event)" />

      <!-- Document cards -->
      <div class="doc-cards" *ngIf="documents.length > 0; else emptyState">
        <mat-card
          class="doc-card"
          *ngFor="let doc of documents"
          (click)="viewDocument(doc)"
        >
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">description</mat-icon>
            <mat-card-title>{{ doc.fileName }}</mat-card-title>
            <mat-card-subtitle>{{ doc.documentType || 'GENERAL' }}</mat-card-subtitle>
          </mat-card-header>

          <mat-card-actions align="end">
            <button
              mat-icon-button
              color="warn"
              (click)="$event.stopPropagation(); deleteDocument(doc.id)"
              matTooltip="Delete"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
      </div>

      <!-- Empty state -->
      <ng-template #emptyState>
        <div class="empty-card">
          <mat-icon>folder_open</mat-icon>
          <h4>No documents yet</h4>
          <p>Upload your first file to get started.</p>
        </div>
      </ng-template>
    </main>
  </mat-sidenav-content>

  <!-- PDF Viewer -->
  <mat-sidenav
    class="dm-viewer"
    position="end"
    mode="over"
    [opened]="viewerOpen"
    (closedStart)="onViewerClosed()"
  >
    <mat-toolbar class="viewer-toolbar" color="primary">
      <span class="viewer-title">{{ viewerName }}</span>
      <span class="spacer"></span>
      <button mat-icon-button (click)="openInNewTab()" matTooltip="Open in new tab">
        <mat-icon>open_in_new</mat-icon>
      </button>
      <button mat-icon-button (click)="downloadCurrent()" matTooltip="Download">
        <mat-icon>download</mat-icon>
      </button>
      <button mat-icon-button (click)="closeViewer()" matTooltip="Close">
        <mat-icon>close</mat-icon>
      </button>
    </mat-toolbar>

    <div class="viewer-body">
      <div class="viewer-loading" *ngIf="loadingViewer">
        <mat-progress-spinner mode="indeterminate" diameter="40"></mat-progress-spinner>
        <div>Loading PDFâ€¦</div>
      </div>

      <object
        *ngIf="!loadingViewer && viewerUrl"
        [data]="viewerUrl"
        type="application/pdf"
        class="pdf-object"
      ></object>
    </div>
  </mat-sidenav>
</mat-sidenav-container>
